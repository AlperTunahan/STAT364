setwd("~/Desktop/STAT364PROJECT")
data <- read.csv("8_Module2_Sim2_Data_V1.csv", sep = ";")
head(data)
colnames(data)
str(data)
data$No_of_tradelines
data
attach(data)
fit3 = lm(Avg_Monthly_balance ~ APR_offered)
summary(fit3)
fit3 = lm(Avg_Monthly_balance ~ APR_offered, data)
summary(fit3)
fit3 = lm(Avg_Monthly_balance ~ as.factor(APR_offered), data)
summary(fit3)
fit3 = lm(Avg_Monthly_balance ~ APR_offered, data)
summary(fit3)
APR_offered = as.factor(APR_offered)
#data handling
data <- read.csv("8_Module2_Sim2_Data_V1.csv", sep = ";")
attach(data)
data$APR_offered = as.factor(data$APR_offered)
# removing unwanted parts
data <- data[,c(-1, -2, -9)]
str(data)
summary(data)
model1 <- lm(Avg_monthly_spend ~ ., data = data)
summary(model1)
car::vif(model1)
plot(model1)
set.seed(42)
hist(data$Avg_monthly_spend, probability = T)
lines(density(rnorm(1001, mean(data$Avg_monthly_spend), sd(data$Avg_monthly_spend))))
summary(model1)
fit3 = lm(Avg_Monthly_balance ~ APR_offered, data)
summary(fit3)
hist(data$Avg_Monthly_balance, probability = T)
ggplot(data, aes(x=as.factor(APR_offered), y=Avg_Monthly_balance,fill=as.factor(APR_offered)))
library(ggplot2)
ggplot(data, aes(x=as.factor(APR_offered), y=Avg_Monthly_balance,fill=as.factor(APR_offered)))
ggplot(data, aes(x = APR_offered, y = Avg_Monthly_balance, fill = APR_offered))
ggplot(data, aes(x = APR_offered, y = Avg_Monthly_balance, fill = APR_offered)) +
geom_boxplot()
data$APR_offered
AID::boxcoxnc(data$Avg_Monthly_balance)
shapiro.test(data$Avg_Monthly_balance)
shapiro.test(data$Avg_Monthly_balance ^ 0.33)
shapiro.test(data$Avg_Monthly_balance ^ 0.43)
shapiro.test(data$Avg_Monthly_balance ^ 0.1)
shapiro.test(data$Avg_Monthly_balance ^ 0.45)
shapiro.test(data$Avg_Monthly_balance ^ 0.33)
shapiro.test(data$Avg_Monthly_balance ^ 0.32)
shapiro.test(data$Avg_Monthly_balance ^ 0.34)
shapiro.test(data$Avg_Monthly_balance ^ 0.33)
fit3 = lm(Avg_Monthly_balance ^ 0.33 ~ APR_offered, data)
summary(fit3)
AID::boxcoxnc(data$Avg_Monthly_balance)
plot(fit3, 1)
plot(fit3, 1)
par(mfrow = c(1,1))
plot(fit3, 1)
summary(fit3)
hist(data$Avg_monthyl_payrate)
AID::boxcoxnc(data$Avg_monthyl_payrate)
hist(data$Avg_monthyl_payrate)
AID::boxcoxnc(data$Avg_monthyl_payrate)
AID::boxcoxnc(scale(data$Avg_monthyl_payrate))
scale(data$Avg_monthyl_payrate)
AID::boxcoxnc(scale(data$Avg_monthyl_payrate))
# Research Question 4
a <- scale(data$Avg_monthyl_payrate)
AID::boxcoxnc(a)
fit4 <- lm(Avg_monthyl_payrate ~ student_loan_ind + Income_Group, data)
summary(fit4)
plot(fit4)
hist(fit4$residuals, probability = T)
par(mfrow = c(1,1))
hist(fit4$residuals, probability = T)
hist(scale(fit4$residuals), probability = T)
fit4 <- lm(scale(Avg_monthyl_payrate) ~ student_loan_ind + Income_Group, data)
summary(fit4)
AID::boxcoxlm(fit4)
car::box.cox(fit4)
car::boxCox(fit4)
MASS::boxcox(fit4)
plot(fit4)
fit4 <- lm(scale(Avg_monthyl_payrate) ~ student_loan_ind + Income_Group, data)
summary(fit4)
plot(fit4)
hist(scale(fit4$residuals), probability = T)
hist(fit4$residuals, probability = T)
fit4 <- lm(Avg_monthyl_payrate ~ student_loan_ind + Income_Group, data)
summary(fit4)
hist(fit4$residuals, probability = T)
plot(data$Avg_monthyl_payrate)
MASS::boxcox(fit4$residuals)
fit4$residuals
MASS::boxcox(fit4)
car::box.cox(fit4)
car::boxCox(fit4)
AID::boxcoxnc(fit4)
AID::boxcoxnc(fit4$residuals)
fit4 <- lm(Avg_monthyl_payrate ~ student_loan_ind + Income_Group, data)
summary(fit4)
AID::boxcoxnc(fit4$residuals)
AID::boxcoxnc(fit4$residuals + 10)
fit4 <- lm(Avg_monthyl_payrate ^ 2.02 ~ student_loan_ind + Income_Group, data)
summary(fit4)
plot(fit4)
ggplot(data, aes(x = APR_offered, y = Avg_Monthly_balance, fill = APR_offered)) +
geom_boxplot()
hist(data$Avg_Monthly_balance, probability = T)
AID::boxcoxnc(data$Avg_Monthly_balance)
fit3 = lm(Avg_Monthly_balance ^ 0.33 ~ APR_offered, data)
summary(fit3)
fit4 <- lm(Avg_Monthly_balance  ~ student_loan_ind + Income_Group, data)
summary(fit4)
plot(fit4)
AID::boxcoxnc(fit4)
AID::boxcoxnc(Avg_Monthly_balance)
fit4 <- lm(Avg_Monthly_balance ^ 0.33  ~ student_loan_ind + Income_Group, data)
summary(fit4)
ggplot(data, aes(x = student_loan_ind, y = Avg_Monthly_balance, fill = Income_Group)) +
geom_boxplot()
ggplot(data, aes(x = Income_Group, y = Avg_Monthly_balance, fill = Income_Group)) +
geom_boxplot()
# Research Question 4
data[data$Income_Group == "9000-12000"]
# Research Question 4
data[,data$Income_Group == "9000-12000"]
# Research Question 4
data[data$Income_Group == "9000-12000",]
summary(fit4)
if(!require(plotly)) install.packages("plotly"); library(plotly)
data2<-cbind(data$Grocery_spend,data$Apparels_spend,data$DE_spend)
data2<-data.frame(data2)
plot_ly(data2,type = "surface")
if(!require(plotly)) install.packages("plotly"); library(plotly)
data2<-cbind(data$Grocery_spend,data$Apparels_spend,data$DE_spend)
data2<-data.frame(data2)
if(!require(plotly)) install.packages("plotly"); library(plotly)
data2<-cbind(data$Grocery_spend,data$Apparels_spend,data$DE_spend)
data2<-data.frame(data2)
plot_ly(data2,type = "surface")
if(!require(plotly)) install.packages("plotly"); library(plotly)
data2<-cbind(data$Grocery_spend,data$Apparels_spend,data$DE_spend)
plot_ly(data2,type = "surface")
plot_ly(data2)
if(!require(plotly)) install.packages("plotly"); library(plotly)
data2<-cbind(data$Grocery_spend,data$Apparels_spend,data$DE_spend)
data2<-data.frame(data2)
plot_ly(data2)
data2
data2<-cbind(data$Grocery_spend,data$Apparels_spend,data$DE_spend)
data2<-data.frame(data2)
plot_ly(head(data2, 50) ,type = "surface")
if(!require(plotrix)) install.packages("plotrix"); library(plotrix)
table(data$Age_group)
a <- c(240,253,245,263)
aa <- round((a/sum(a))*100)
b <- c("18-25","25-35","35-55","55+")
pie3D(a,labels = paste(b,"\n" ,sep = " ",aa, "%"),col = c("olivedrab3","lightsalmon2","orange2","tomato2"), explode = 0.05, main= "Age Group",theta = 0.5,radius = 1)
table(data$Income_Group)
c <- c(197,196,179,202,227)
cc <- round((a/sum(a))*100)
d <- c("0-3000","3000-6000","6000-9000","9000-12000","12000+")
pie3D(c,labels = paste(d,"\n" ,sep = " ",cc, "%"),col = c("cornsilk2", "lightpink2", "slategray2","salmon1","plum"), explode = 0.05, main= "Income Group",theta = 0.6,radius = 1)
par(mfrow = c(1,1))
table(data$Age_group)
a <- c(240,253,245,263)
aa <- round((a/sum(a))*100)
b <- c("18-25","25-35","35-55","55+")
pie3D(a,labels = paste(b,"\n" ,sep = " ",aa, "%"),col = c("olivedrab3","lightsalmon2","orange2","tomato2"), explode = 0.05, main= "Age Group",theta = 0.5,radius = 1)
table(data$Income_Group)
c <- c(197,196,179,202,227)
cc <- round((a/sum(a))*100)
d <- c("0-3000","3000-6000","6000-9000","9000-12000","12000+")
pie3D(c,labels = paste(d,"\n" ,sep = " ",cc, "%"),col = c("cornsilk2", "lightpink2", "slategray2","salmon1","plum"), explode = 0.05, main= "Income Group",theta = 0.6,radius = 1)
summary(model1)
effectsize::standardize_parameters(model1)
summary(model1)
summary(model1)
effectsize::standardize_parameters(model1)
car::vif(model1)
# Normality check for resiudals
hist(model1$residuals, probability = T)
lines(density(rnorm(1001, mean(model1$residuals), sd(model1$residuals))))
model1 <- lm(Avg_monthly_spend ~ ., data = data)
summary(model1)
plot(model1)
summary(model1)
car::vif(model1)
car::vif(model1)
model1 <- lm(Avg_monthly_spend ~ ., data = data)
model1 <- lm(Avg_monthly_spend ~ ., data = data)
car::vif(model1)
data <- read.csv("8_Module2_Sim2_Data_V1.csv", sep = ";")
attach(data)
data$APR_offered = as.factor(data$APR_offered)
# removing unwanted parts
data <- data[,c(-1, -2, -9)]
str(data)
model1 <- lm(Avg_monthly_spend ~ ., data = data)
car::vif(model1)
car::vif(model1)
a <- car::vif(model1)
car::vif(model1)
table(car::vif(model1))
install.packages("formattable")
library(formattable)
car::vif(model1)
type(car::vif(model1))
a <- car::vif(model1)
plot(model1)
ggplot(data, aes(x=Age_group, y=Travel_spend,fill=Age_group))+
geom_boxplot() +
scale_fill_viridis(discrete = TRUE, alpha=0.6) +
geom_jitter(color="black", size=0.4, alpha=0.9) +
theme(legend.position="none",
plot.title = element_text(size=11)
)
fit2 = lm(Travel_spend ^ 0.43 ~ Age_group, data)
summary(fit2)
hist(data$Travel_spend, probability = T)
lines(density(rnorm(1001, mean(data$Travel_spend), sd(data$Travel_spend))))
AID::boxcoxnc(data$Travel_spend)
set.seed(42)
shapiro.test(sample(data$Travel_spend^0.43, 50))
ggplot(data, aes(x=Age_group, y=Travel_spend,fill=Age_group))+
geom_boxplot() +
scale_fill_viridis(discrete = TRUE, alpha=0.6) +
geom_jitter(color="black", size=0.4, alpha=0.9) +
theme(legend.position="none",
plot.title = element_text(size=11)
)
ggplot(data, aes(x=Age_group, y=Travel_spend,fill=Age_group)) +
geom_violin() +
scale_fill_viridis(discrete = TRUE, alpha=0.6, option="A") +
theme(legend.position="none",
plot.title = element_text(size=11)
)
ggplot(data, aes(x=Age_group, y=Travel_spend,fill=Age_group)) +
geom_boxplot() +
scale_fill_viridis(discrete = TRUE, alpha=0.6) +
theme(legend.position="none",
plot.title = element_text(size=11)
)
library(viridis)
ggplot(data, aes(x=Age_group, y=Travel_spend,fill=Age_group)) +
geom_violin() +
scale_fill_viridis(discrete = TRUE, alpha=0.6, option="A") +
theme(legend.position="none",
plot.title = element_text(size=11)
)
ggplot(data, aes(x=Age_group, y=Travel_spend,fill=Age_group)) +
geom_boxplot() +
scale_fill_viridis(discrete = TRUE, alpha=0.6) +
theme(legend.position="none",
plot.title = element_text(size=11)
)
library(ggridges)
ggplot(data, aes(x = Travel_spend, y = Age_group, fill = Age_group)) +
geom_density_ridges() +
theme_ridges() +
theme(legend.position = "none")
effectsize::standardize_parameters(model1)
a <- car::vif(model1)
a
tab_model(model1)
install.packages("tab_model")
library(sjPlot)
install.packages("sjPlot")
installed.packages("sjmisc")
install.packages("sjlabelled")
library(sjPlot)
library(sjmisc)
library(sjlabelled)
tab_model(model1)
#data handling
data <- read.csv("8_Module2_Sim2_Data_V1.csv", sep = ";")
attach(data)
data$APR_offered = as.factor(data$APR_offered)
# removing unwanted parts
data <- data[,c(-1, -2, -9)]
str(data)
#data handling
data <- read.csv("8_Module2_Sim2_Data_V1.csv", sep = ";")
attach(data)
data$APR_offered = as.factor(data$APR_offered)
data$APR_offered = as.factor(data$APR_offered)
# removing unwanted parts
data <- data[,c(-1, -2, -9, -11)]
str(data)
model1 <- lm(Avg_monthly_spend ~ ., data = data)
summary(model1)
tab_model(model1)
effectsize::standardize_parameters(model1)
fit2 = lm(Travel_spend  ~ Age_group, data)
summary(fit2)
plot(fit2)
plot(fit2, 1)
par(mfrow, c(1,1))
par(mfrow = c(1,1))
plot(fit2, 1)
tab_model(fit2)
tab_model(AID::boxcoxnc(data$Travel_spend))
tab_model(AID::boxcoxnc(data$Travel_spend))
AID::boxcoxnc(data$Travel_spend)
AID::boxcoxnc(data$Avg_monthly_spend)
fit3 = lm(Avg_Monthly_balance ~ APR_offered, data)
summary(fit3)
tab_model(fit3)
hist(data$Avg_Monthly_balance)
par(mfrow = c(1,1))
hist(data$Avg_Monthly_balance)
par(mfrow = c(2,1))
plot(fit3, c(1,2)) # No relation
par(mfrow = c(1,2))
plot(fit3, c(1,2)) # No relation
AID::boxcoxnc(data$Avg_Monthly_balance)
fit3 = lm(Avg_Monthly_balance ^ 0.33 ~ APR_offered, data)
summary(fit3)
tab_model(fit3)
fit4 <- lm(Avg_Monthly_balance ^ 0.33  ~ student_loan_ind + Income_Group, data)
tab_model(fit4)
par(mfrow = c(1,2))
plot(fit2 ,c (1,2))
plot(model1, c(1,2))
boxplot(Travel_spend, Age_group)
p<-ggplot(Travel_spend, aes(color=Age_group)) +
geom_boxplot()
# model output
tab_model(fit1)
library(sjPlot)
# model output
tab_model(fit1)
